# Homework 3: External libraries: application to a heat equation solver

Authors: Chenyang Wang & Mikele Gajda

## Tested Dependencies
1. Python v.3.8.3

## Prerequisites
- To include the FFTW package and link it to the executable, the user should make sure that the relative option in the `CMakeLists.txt` has been set to: `ON`.

- The GoogleTest package is also necessary and should be included. This can be done by the following command:
```
git submodule update --init

```
After compilation the following tests can be run:
- `./test_fft`
- `./test_heat`
- `./test_kepler`
## How to build
```
1. cd {PROJECT_FOLDER}/homework_3
2. mkdir build && cd build 
3. cmake .. -DUSE_FFTW=ON #follow the instruction to update git submodule
4. make
```

## Ex. 1
The additional classes available for the project are here described:

- **MaterialPoint:** This class derives form `Particle` class, as shown in `material_point.hh`, and adds properties for the heat rate and temperature;

- **Matrix:** It is a class template added to provide manipulation functions for 2D data; 

- **MaterialPointFactory:** It is factory class derived using `particles_factory_interface.hh` that provides a simulation of a system composed by material points.

- **FFT:** It is a class needed to compute the 2D discrete Fourier Transformation handled in form of a complex matrix.

## Ex. 4
### Question 4.5
In the last step of ComputeTemperature::compute() function to set the new temperature, if the particle is on the boundary, we enforce the temperature value as zero. Other, we do the normal update. 

### Question 4.6
To produce dumps observable with Paraview, the user should reproduce step by step the following procedure:

1. Generate an initial particle distribution. To allow that, we developed the `generate_heat_source.py` script that takes the following parameters as input:

    - Radius: `-r 1` to give radius = 1;
    - Number of particles per row: `-n 512` to create 512x512 grid;
    - Domain width: `-d 2` to have x ranging between (-1,1) and y from (-1,1);
    - Filename (optional): `-f input_file.csv` to assign a different name to the output generated.

    To run the script with usual parameters, one can type the following line after moving to the folder containing the script (as usual):
    ```
    python generate_distribution.py -r 1 -n 512 -d 2
    ```

    After the execution, the output file indicating the particle evolution over time is generated and can be used for animation in Paraview.
2. Create `build` folder in project directory and then compile the program as follows:
    ```
    cmake ..
    make
    ```
    After this, just create a `dumps` folder as follows inside src:
    ```
    cd src && mkdir dumps
    ```
3. Run the simulation after compilation using the `particles` executable as follows:
    ```
    ./particles nsteps dump_freq input.csv particle_type timestep
    ```
    where the arguments are:

    * ```nsteps```: Number of integration steps (input type: int);
    * ```dump freq (int)```: Dumping frequency (input type: int);
    * ```input.csv```: Name of the input file generated by the provided script as described in `step 1` (input type: string);
    * ```particle_type``` Particles type,```material_point``` in this ex. (input type: string); 
    * ```timestep```: Timestep for the integration (input type: float).

    Full call example:
    ```
    ./particles 10000 100 ../input.csv material_point .31
    ```
4. To visualize with Paraview: launch the software and move to `dumps/` folder location where the output of the execution has been saved in form of .csv files. Open the dataset with the csv reader defining `no header` and `[space]` as delimiter.
Afterwards, go to Filters/Alphabetical/Table To Points. Columns 0, 1, 2 are the coordinates X, Y, Z: set them as mentioned. Next, the user can choose column13 (temperature) and column14 (heat) with colors and then the animation can be viewed.


